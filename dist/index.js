!function(){function t({state:t,event:e}){return null!==e&&"input"===e.type&&"username"===e.target.id?e.target.value:t.username}function e({state:t,event:e}){return null!==e&&"input"===e.type&&"password"===e.target.id?e.target.value:t.password}function n({state:t,event:e}){return null!==e&&"submit"===e.type&&"loginForm"===e.target.id?(e.preventDefault(),!0):(!t.loading||null===e||"fetchResult"!==e.type)&&t.loading}function o({state:t,event:e}){return null!==e&&"submit"===e.type&&"loginForm"===e.target.id}function r({state:t,event:e}){return null!==e&&"fetchResult"===e.type?e.data?"success":"failed":t.loginState}function u(t,e){if(t.nodeName!==e.nodeName)t.parentNode.replaceChild(e,t);else if(t.nodeType===Node.TEXT_NODE)t.textContent!==e.textContent&&(t.textContent=e.textContent);else{for(const{name:n,value:o}of e.attributes)t.getAttribute(n)!==o&&t.setAttribute(n,o);for(const{name:n}of[...t.attributes])e.hasAttribute(n)||t.removeAttribute(n);const n=[...t.childNodes],o=[...e.childNodes];if(n.length<o.length)for(let e=n.length;e<o.length;e++)t.appendChild(o[e]);if(n.length>o.length)for(let e=o.length;e<n.length;e++)t.removeChild(n[e]);const r=Math.min(n.length,o.length);for(let t=0;t<r;t++)u(n[t],o[t])}}function i(t){const e=document.createElement("body");e.innerHTML=t,u(document.body,e)}function s(...t){return e=>t.reduce(((t,e)=>e(t)),e)}const a=s((function(u){return{...u,state:{...u.state,username:t(u),password:e(u),loading:n(u),requesting:o(u),loginState:r(u)}}}),(function(t){const{state:{requesting:e,username:n,password:o}}=t;return{...t,fetch:e?{url:"login.php",data:{username:n,password:o}}:null}}),(function(t){const{state:{loginState:e,loading:n,username:o,password:r}}=t;return{...t,html:"idle"===e?`\n\t\t\t\t<form id="loginForm">\n\t\t\t\t\tUsername: <input id="username"${n?" disabled":""} value="${o}"><br>\n\t\t\t\t\tPassword: <input id="password" type="password"${n?" disabled":""} value="${r}"><br>\n\t\t\t\t\t<button${n?" disabled":""}>Login</button>\n\t\t\t\t</form>\n\t\t\t`:"success"===e?"Login success!":"Login failed!"}}));s((function(t){let e=!0;return function(n){const o=t(n);return null!==o.html&&(e?(document.body?i(o.html):addEventListener("DOMContentLoaded",(function(){i(o.html)})),e=!1):i(o.html)),o}}),(function(t){return function(e){const n=t(e);return null!==n.fetch&&fetch(n.fetch.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Object.entries(n.fetch.data).map((function([t,e]){return`${t}=${encodeURI(e)}`})).join("&")}).then((function(t){return t.json()})).then((function(t){dispatchEvent(Object.assign(new Event("fetchResult"),{data:t}))})),n}}),(function(t){let e;return function(n){void 0===e&&(e=n.state);const o=t({...n,state:e});return e=o.state,o}}),function(...t){return function(e){let n=!0;return function(o){if(n){for(const n of t)addEventListener(n,(function(t){e({...o,event:t})}));n=!1}return e({...o,event:null})}}}("input","submit","fetchResult"))(a)({state:{username:"",password:"",loginState:"idle"}})}();